define(["jquery","ageGate/vms/ageGate","common/lib/env","knockout"],function(e,t,n,r){var i=function(i,s){var o=this;o.baseUrl=n.baseUrl,o.id=s,o.ageGate=t,o.dealClaimShow=r.observable(!0),o.email=r.observable(""),o.dealClaimSuccessful=r.observable(!1),o.dealClaimError=r.observable(!1),o.init=function(){console.log("Activated VM")},o.showDealClaim=function(){if(!o.ageGate.isAgeGateVerified())return;o.dealClaimShow(!0)},o.clearDealStatus=function(){o.dealClaimError(!1),o.dealClaimSuccessful(!1)},o.claimThisDeal=function(t,n){if(o.email()=="")return;var r=e.ajax({url:o.baseUrl.concat("/deal/claimOpenDeals/").concat(o.id),type:"POST",data:{email:o.email(),id:o.id},dataType:"json"});r.fail(function(e,t){o.dealClaimSuccessful(!1),o.dealClaimError(!0)}),r.done(function(e,t){o.dealClaimSuccessful(!0),o.dealClaimError(!1)}),r.always(function(e,t){console.log(t==="error"),t==="error"&&(o.dealClaimSuccessful(!1),o.dealClaimError(!0))})},o.updateLocation=function(e){console.log("Preferred Locations"+
r.toJSON(e))}};return i});